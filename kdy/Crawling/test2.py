from konlpy.tag import Okt
import networkx as nx
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

# 다운로드 받은 폰트 파일의 경로를 설정합니다.
font_path = 'NanumGothic.ttf' 

# 폰트 파일을 matplotlib의 폰트로 설정합니다.
font_prop = fm.FontProperties(fname=font_path)

def textrank_keyword_extraction_and_visualization(text, num_keywords):
    # Konlpy의 Okt 형태소 분석기를 사용하여 문장을 토큰화합니다.
    okt = Okt()
    tokens = okt.phrases(text)

    # 토큰들을 그래프의 노드로 사용하고, 각 노드들을 연결합니다.
    graph = nx.Graph()
    graph.add_nodes_from(tokens)

    # 토큰들 사이에 엣지를 추가합니다. 이 예제에서는 각 토큰이 문장 내에서 인접한 경우에만 엣지를 추가합니다.
    for i in range(len(tokens) - 1):
        edge = (tokens[i], tokens[i+1])
        if not graph.has_edge(*edge):
            graph.add_edge(*edge)

    # PageRank 알고리즘을 사용하여 각 노드의 중요도를 계산합니다.
    scores = nx.pagerank(graph)

    # 계산된 중요도를 기준으로 노드들을 내림차순으로 정렬하고, 상위 num_keywords개의 키워드를 반환합니다.
    ranked_nodes = sorted(((score, node) for node, score in scores.items()), reverse=True)
    keywords = [node for score, node in ranked_nodes[:num_keywords]]

    # 그래프를 시각화합니다.
    plt.figure(figsize=(12, 12))
    pos = nx.spring_layout(graph)
    nx.draw_networkx_nodes(graph, pos)
    nx.draw_networkx_edges(graph, pos)
    for node, (x, y) in pos.items():
        plt.text(x, y, node, fontsize=10, ha='center', va='center', fontproperties=font_prop)
    # plt.show()

    return keywords

text = """
[프라임경제] 보험 시장은 국민 대다수가 가입할 만큼 풍부한 수요를 확보했음에도, 치열한 경쟁이 펼쳐지는 '레드오션'으로 꼽힌다. 이에 보험사는 시장 내 입지 확보 차원에서 각종 새로운 상품과 마케팅과 같은 프로모션을 쏟아내고 있다. 본지는 'T·M·I(Too Much Insurance)'를 통해 보험사 정보를 들려주고자 한다.

오늘의 보험 TMI 주인공 △한화생명 △교보생명 △DB손해보험 △카카오페이손해보험

◆'혹서기 극복' 한화생명, 찾아가는 카페 행사

한화생명(088350)이 한화생명금융서비스 의정부지역단 영업현장을 방문해 재무설계사(FP)에게 커피와 쿠키를 전달하고 응원 메시지를 지난 1일 전달했다.

'찾아가는 한화생명 시그니처 카페' 행사는 9월11일까지 진행된다. 한화생명 자회사 △한화생명금융서비스 △한화라이프랩 △피플라이프 등 전국 80개 지역단과 사업단을 찾아간다.

한화생명이 한화생명금융서비스 의정부지역단 영업현장을 방문해 재무설계사에게 커피와 쿠키를 전달했다. ⓒ 한화생명 
한화생명이 한화생명금융서비스 의정부지역단 영업현장을 방문해 재무설계사에게 커피와 쿠키를 전달했다. ⓒ 한화생명


한화생명은 2015년부터 2018년까지 매년 차량을 이용해 이동식 카페 행사를 진행했다. 올해는 코로나19 유행 이후 5년 만에 영업현장 소통 강화를 위해 '찾아가는 한화생명 시그니처 카페'라는 이름으로 운영을 재개했다.

아침과 점심 휴식시간 동안 각 지역단과 사업단의 지점장이 직접 이동식 카페에서 FP에게 간식을 제공한다. 

◆"ESG경영" 교보생명, 13번째 지속가능경영보고서 발간

교보생명이 지속가능경영보고서 '사람, 그리고 미래'를 발간했다고 2일 밝혔다. 지난해 지속가능경영 추진 노력과 ESG 관련성과를 담았다.

교보생명은 2011년 업계 최초로 지속가능경영보고서를 발간했다. 매년 ESG경영 노력과 성과를 공유하고 있다. 올해로 13회차를 맞았다. 신창재 교보생명 대표이사 겸 이사회 의장이 추구해온 '모든 이해관계자들과의 공동 발전 추구'라는 지속가능경영철학을 바탕으로 차별화된 ESG경영 기반을 일찍이 구축했다는 평이다.

교보생명이 13번째 지속가능경영보고서를 발간했다. ⓒ 교보생명 
교보생명이 13번째 지속가능경영보고서를 발간했다. ⓒ 교보생명


이번 보고서는 ESG경영 흐름에 발맞춰 관련 정보 공시를 강화했다. 지속가능성을 높이기 위한 교보생명의 경영철학 역사를 따로 다뤘다. 이사회 산하 지속가능ESG위원회와 ESG협의회 및 ESG실무협의회 등 'ESG 거버넌스' 현황과 2025년까지 추진할 'ESG 추진 로드맵' 등을 담았다.

아울러 △환경경영 △인권경영 △인재개발 △안전보건 △윤리경영 △지배구조 △리스크 관리 등의 추진 노력과 성과를 소개했다. 금융안정위원회(FSB)에서 설립한 기후변화 관련 재무정보공개 전담협의체(TCFD) 권고안에 따른 내용도 보고서에서 다뤘다.

이밖에도 △환경경영시스템 국제표준 ISO14001 인증 △부패방지경영시스템 국제표준 ISO 37001 인증 △5억달러 규모 지속가능채권 발행 △소비자보호헌장 선포 △스타트업과의 상생 생태계 강화 등의 성과도 보고서에 게재했다.

◆DB손보, 서울시 유기동물 보험사업 최종사업자 선정

DB손해보험(005830)은 '2023년 서울시 유기동물 안심보험 지원사업'에 최종 사업자로 선정돼 3년 연속 사업을 시행하고 있다고 2일 밝혔다.

올해 시행되는 '서울시 유기동물 안심보험 지원사업'은 지난해 유기견으로 제한됐던 가입조건이 완화돼 유기묘까지 확장됐다. 유기동물의 질병·상해·안전사고에 대한 불안감을 해소하고, 유기동물의 입양률을 높인다는 목적으로 시행하고 있다.

DB손해보험이 서울시가 운영하는 유기동물 안심보험 지원사업자로 최종 선정됐다. ⓒ DB손해보험 
DB손해보험이 서울시가 운영하는 유기동물 안심보험 지원사업자로 최종 선정됐다. ⓒ DB손해보험


유기동물 입양가족에게 제공되는 DB손해보험의 '프로미 반려동물보험'은 입양한 유기동물의 질병 또는 상해로 인한 치료비와 수술비를 보장한다. 아울러 입양한 유기동물이 타인의 신체에 피해를 입히거나 타인의 반려동물에 손해를 입혀 부담하는 배상책임 손해도 보장한다.

보험기간은 가입신청일로부터 1년이다. 동물보호·입양센터에서 유기동물을 입양하면서 보험가입을 신청한 입양가족에게 서울시가 '프로미 반려동물보험' 1년 치 보험료를 지원한다. 보험가입신청은 올해 12월31일까지 가능하다. 다만, 예산이 조기 소진될 시 가입이 불가할 수 있다.

◆카카오페이손보, 골프예약 플랫폼 구독 서비스 개시

디지털 손해보험사 카카오페이손해보험은 스포츠에 재미를 더하는 플랫폼 기업 카카오 VX가 서비스하는 '카카오골프예약' 플랫폼에서 우천 시 홀아웃 보상을 포함해 골프에 필요한 다양한 혜택을 담은 '멤버십(구독)' 서비스를 함께 시작했다고 밝혔다.
 
멤버십 서비스는 라운드 때 꼭 필요한 혜택을 모아 제공한다. 서비스 출시를 기념해 8월까지 첫 달 월 100원의 구독료만 내면 △우천 시(낙뢰나 비) 홀아웃 보상 △그린피 지원 및 필드 홀인원 보상 △골프 중 배상책임보상과 아울러 카카오VX의 △카카오프렌즈 골프 할인 혜택 △무제한 청약 △무제한 자동매칭 △선결제 쿠폰팩을 누릴 수 있다.
 
카카오페이손보가 카카오 VX가 서비스하는 플랫폼에서 골프에 필요한 혜택을 담은 서비스를 시작했다. ⓒ 카카오페이손해보험 
카카오페이손보가 카카오 VX가 서비스하는 플랫폼에서 골프에 필요한 혜택을 담은 서비스를 시작했다. ⓒ 카카오페이손해보험


카카오 VX 멤버십 서비스에는 카카오페이손해보험의 보험 상품이 포함됐다. 가령 홀인원 보험이나 골프 상해보험의 경우 업계에도 비슷한 상품이 있지만, 골퍼들이 보험사를 통해 각각 따로 가입해야 하는 번거로움이 있었다. 잦은 기상이변으로 인해 라운드 날에 갑작스러운 악천후로 고민하는 골퍼들도 증가해 기상악화 보험까지 혜택에 포함했다.
 
더불어 카카오 VX가 제공하는 다양한 혜택도 한 번에 받을 수 있다. 카카오 VX가 2021년 4월 업계 최초 출시해 특허를 보유한 '티타임 청약'(골프장 티타임 오픈 전 이용자가 원하는 골프장과 날짜, 시간대를 선택해 미리 청약한 뒤 추첨 통해 예약 대기까지 가능한 기능)도 이번 멤버십 서비스 출시를 맞아 업그레이드됐다. 

멤버십 가입자는 골프장 홈페이지에서 새롭게 오픈되는 티타임을 기다리지 않아도 '오픈런 청약'을 통해 원하는 시간대에 청약 신청을 할 수 있다. 특정 골프장을 예약하고자 지속적으로 검색하고 대기하지 않아도 '잔여 티 청약'으로 반복적으로 원하는 티타임 확인 없이 청약 등록이 가능하다.
"""

keywords = textrank_keyword_extraction_and_visualization(text, 10)
print("Top 5 keywords: ", keywords)
